% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/14_write_comparison_results.R
\name{write_comparison_results}
\alias{write_comparison_results}
\title{Write chromcall 2-sample comparison results to file}
\usage{
write_comparison_results(x, file)
}
\arguments{
\item{x}{A \code{\link{GRanges}} object generated by \link{compare_samples}}

\item{file}{Output file path (should end in \code{.tsv})}
}
\value{
A \code{data.frame} invisibly, also written to \code{file}
}
\description{
Converts the result of \link{compare_samples} — a \code{\link{GRanges}} object containing
differential region-level statistics — into a \code{data.frame} and writes it to a
tab-delimited \code{.tsv} file. The \code{strand} column is removed (if present), and
the chromosome column is renamed to "chr" for consistency.
}
\examples{
# Load example files from package
genome_file <- system.file("extdata", "genome.txt", package = "chromcall")
region_file <- system.file("extdata", "example.bed", package = "chromcall")
blacklist_file <- system.file("extdata", "blacklist.bed", package = "chromcall")

bam_dir <- system.file("extdata", package = "chromcall")
expr_file1 <- system.file("extdata", "expression_sampleA.bed", package = "chromcall")
expr_file2 <- system.file("extdata", "expression_sampleB.bed", package = "chromcall")

# Define BAMs for two samples
experiments_1 <- list(
  H3K4me3 = file.path(bam_dir, "h3k4me3_sampleA.bam"),
  Control = file.path(bam_dir, "control_sampleA.bam")
)
experiments_2 <- list(
  H3K4me3 = file.path(bam_dir, "h3k4me3_sampleB.bam"),
  Control = file.path(bam_dir, "control_sampleB.bam")
)

# Build chromcall samples (with expression files)
sample1 <- build_chromcall_sample(
  sample_name = "sampleA",
  experiments = experiments_1,
  control_name = "Control",
  genome_file = genome_file,
  region_file = region_file,
  window_size = 10000,
  blacklist_file = blacklist_file,
  expression_file = expr_file1
)

sample2 <- build_chromcall_sample(
  sample_name = "sampleB",
  experiments = experiments_2,
  control_name = "Control",
  genome_file = genome_file,
  region_file = region_file,
  window_size = 10000,
  blacklist_file = blacklist_file,
  expression_file = expr_file2
)

# Perform region-level analysis on each sample
result1 <- test_region_counts(sample1)
result2 <- test_region_counts(sample2)

# Run two-sample comparison test
comparison <- compare_samples(result1, result2, experiment = "H3K4me3")

# Export comparison result to file (includes expression columns if available)
out_file <- tempfile(fileext = ".tsv")
write_comparison_results(comparison, out_file)
read.table(out_file, header = TRUE)

}
