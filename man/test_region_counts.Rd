% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/11_test_region_counts.R
\name{test_region_counts}
\alias{test_region_counts}
\title{Test region counts in a chromcall sample}
\usage{
test_region_counts(x, trim_blacklist = TRUE)
}
\arguments{
\item{x}{A \link{RangedSummarizedExperiment} object containing counts and metadata.}

\item{trim_blacklist}{Logical; if \code{TRUE}, removes rows where \code{blacklist == TRUE} before testing.}
}
\value{
A modified \link{RangedSummarizedExperiment} object with additional assays:
\code{logFC}, \code{lambda_t}, \code{p_value}, and \code{p_adj}; and a rowData column \code{modification_factor}.
}
\description{
Conduct Poisson-based statistical tests on read counts across genomic regions
in a chromcall \link{RangedSummarizedExperiment} object. While originally designed
for promoter analysis, this function can be applied to any genomic region set.
}
\examples{
# See ?build_chromcall_sample for how to construct a sample
sample <- build_chromcall_sample(
  sample_name = "sampleA",
  experiments = list(
    H3K27me3 = system.file("extdata", "h3k27me3_sampleA.bam", package = "chromcall"),
    H3K4me3 = system.file("extdata", "h3k4me3_sampleA.bam", package = "chromcall"),
    Control = system.file("extdata", "control_sampleA.bam", package = "chromcall")
  ),
  control_name = "Control",
  genome_file = system.file("extdata", "genome.txt", package = "chromcall"),
  region_file = system.file("extdata", "example.bed", package = "chromcall"),
  window_size = 10000,
  blacklist_file = system.file("extdata", "blacklist.bed", package = "chromcall"),
  expression_file = system.file("extdata", "expression_tss.bed", package = "chromcall")
)
result <- test_region_counts(sample)

# Explore output
SummarizedExperiment::assayNames(result)       # Assays: counts, logFC, lambda_t, p_value, p_adj
head(SummarizedExperiment::assay(result, "counts"))
head(SummarizedExperiment::assay(result, "lambda_t"))
head(SummarizedExperiment::assay(result, "p_adj"))
head(SummarizedExperiment::rowData(result)$expression)
SummarizedExperiment::colData(result)          # Experiment metadata (e.g. lambda_g)
head(SummarizedExperiment::rowData(result))    # Region-level info (e.g. modification_factor)

}
