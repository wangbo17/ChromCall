% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/09_build_chromcall_sample.R
\name{build_chromcall_sample}
\alias{build_chromcall_sample}
\title{Create a chromcall sample from input files}
\usage{
build_chromcall_sample(
  sample_name,
  experiments,
  paired = TRUE,
  control_name = NULL,
  genome_file,
  region_file,
  window_size,
  blacklist_file = NULL,
  expression_file = NULL
)
}
\arguments{
\item{sample_name}{The name of the sample (string).}

\item{experiments}{A named list of BAM file paths for each experiment
(e.g., \code{list(H3K27me3="...", Control="...")} or for ATAC-seq \code{list(ATAC="...")}).}

\item{paired}{Logical. If TRUE (default), input BAM is assumed to be paired-end and reads are
loaded as fragments. If FALSE, input BAM is treated as single-end.}

\item{control_name}{The name (matching \code{names(experiments)}) of the experiment to treat
as control. Set to \code{NULL} to enable no-control mode.}

\item{genome_file}{Path to the genome info text file.}

\item{region_file}{Path to the BED file defining target regions (e.g., promoters).}

\item{window_size}{Genome tile size in base pairs.}

\item{blacklist_file}{Optional path to a BED file of blacklist regions, or NULL to disable.}

\item{expression_file}{Optional path to a BED-format TSS expression file to merge expression into regions.}
}
\value{
A \link[SummarizedExperiment:RangedSummarizedExperiment-class]{SummarizedExperiment::SummarizedExperiment} object containing region counts and lambda estimates.
}
\description{
Constructs a single-sample \link[SummarizedExperiment:RangedSummarizedExperiment-class]{SummarizedExperiment::SummarizedExperiment} object by loading
one or more experiments (e.g., histone marks, CUT&RUN, or ATAC-seq) with a shared genome,
promoter windows, and optional blacklist information. For each experiment, it counts reads
in the target regions and estimates a genome-wide background lambda using tiled genome windows.

By default, ChromCall expects a matched input/control track (specified via \code{control_name}).
If \code{control_name} is \code{NULL}, ChromCall will run in \emph{no-control mode}, which is useful for data
types such as ATAC-seq. In no-control mode, downstream testing should assume background
weighting is constant (effectively 1), i.e. no input-based correction is applied.
}
\examples{
## With control (ChIP/CUT&RUN-style)
genome_file <- system.file("extdata", "genome.txt", package = "chromcall")
region_file <- system.file("extdata", "example.bed", package = "chromcall")
blacklist_file <- system.file("extdata", "blacklist.bed", package = "chromcall")

bam_dir <- system.file("extdata", package = "chromcall")
experiments <- list(
  H3K27me3 = file.path(bam_dir, "h3k27me3_sampleA.bam"),
  H3K4me3  = file.path(bam_dir, "h3k4me3_sampleA.bam"),
  Control  = file.path(bam_dir, "control_sampleA.bam")
)

sample <- build_chromcall_sample(
  sample_name     = "sampleA",
  experiments     = experiments,
  control_name    = "Control",
  genome_file     = genome_file,
  region_file     = region_file,
  window_size     = 10000,
  blacklist_file  = blacklist_file,
  expression_file = system.file("extdata", "expression_tss.bed", package = "chromcall")
)

# Explore output (with control)
sample
SummarizedExperiment::assayNames(sample)
SummarizedExperiment::colData(sample)
head(SummarizedExperiment::assay(sample, "counts"))
head(SummarizedExperiment::rowData(sample)$expression)

## No-control mode (ATAC-seq-style)
# Note: we use a package example BAM here for demonstration only.
atac_sample <- build_chromcall_sample(
  sample_name     = "ATAC_A",
  experiments     = list(ATAC = file.path(bam_dir, "h3k27me3_sampleA.bam")),
  control_name    = NULL,
  genome_file     = genome_file,
  region_file     = region_file,
  window_size     = 10000,
  blacklist_file  = blacklist_file,
  expression_file = system.file("extdata", "expression_tss.bed", package = "chromcall")
)

# Explore output (no-control)
atac_sample
SummarizedExperiment::assayNames(atac_sample)
SummarizedExperiment::colData(atac_sample)
head(SummarizedExperiment::assay(atac_sample, "counts"))

# After region-level testing (no-control)
atac_res <- test_region_counts(atac_sample)
SummarizedExperiment::assayNames(atac_res)
head(SummarizedExperiment::assay(atac_res, "score"))

}
